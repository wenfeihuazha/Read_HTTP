# 第三章 HTTP报文内的HTTP信息

## 3.1 HTTP报文
概念: 用于HTTP协议交互的信息被称为HTTP报文
> HTTP报文大致可以分为报文首部和主体.(通常,并不一定要有报文主体)

## 3.2 请求报文及相应报文的结构
请求报文和响应报文

| 请求报文 | 响应报文 |
|:---: |:--- |
|请求行|响应行|
|请求首部字段|请求首部字段|
|通用首部字段|通用首部字段|
|实体首部字段|实体首部字段|
|其他|其他|

> 请求行: 包含用于请求的方法,请求URI和HTTP版本  
> 状态行: 包含表明响应结果的状态码,原因短语和HTTP版本
> 首部字段: 包含表明请求和响应的各种条件和树形的各类首部(一般有四种首部:通用首部,请求首部,响应首部和实体首部)
> 其他: 可能包含HTTP的RFC里未定义的首部(cookie等)

## 3.3 编码提升传输速率

### 3.3.1 报文主体和实体主体的差异

#### 报文
是HTTP通信中的基本单位,由 **8位** 组字节流组成,通过HTTP通信传输.

#### 实体
作为请求或响应的有效载荷数据(补充项)被传输,其内容由实体首部和实体主体组成  

HTTP报文的主体用于传输请求或响应的实体主体  
通常,**报文主体等于实体主体**.只有当传输中进行**编码操作**时,实体主体的内容发生变化,才导致他和报文主体产生**差异**

### 3.3.2 压缩传输的内容编码
HTTP协议中有一种被称为内容编码的功能能进行这种操作.
> 内容编码指明应用在实体内容上的编码格式,并保持实体信息原样压缩(参考zip?).内容编码后的实体由客户端接收并负责解码
>> 常用的内容编码有几种
>> |内容编码|
>> |:---:|
>> |gzip(GNU zip)|
>> |compress(UNIX系统的标准压缩)|
>> |deflate(zlib)|
>> |identity(不进行编码)|

### 3.3.3 分割发送的分块传输编码
传输大容量数据时,通过把数据分割成多块,能够让浏览器逐步显示页面  
这种把实体主体分块的功能成为分块传输编码
> 分块传输编码会将实体主体分成多个部分.每一块都会用十六进制来标记块的大小. **最后一块会使用"0(CR+LF)"来标记**

## 3.4 发送多种数据的多部分对象集合

| multipart/form-data | multipart/byteranges |
|:----: |:----: |
| 在web表单文件上传时使用 | 状态码206 响应报文包含了多个范围的内容时使用 |

## 3.5 获取部分内容的范围请求
为了应对网络中断请求必须重新开始的情况,需要一种可以恢复下载的机制
下载不同范围时的写法
* 5001 ~ 10000字节
> Range: bytes=5001-10000
* 从5001之后的全部
> Range: bytes=5001-
* 从开始3000字节和5000-7000字体的多重范围
> Range: bytes=0-3000,5000-7000

